<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Security Measures - Authelia</title> <link rel="shortcut icon" href="/docs/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/docs/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-124926127-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-124926127-1'); </script> <script type="text/javascript" src="/docs/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/docs/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Security Measures | Authelia</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Security Measures" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Authelia is an open source multi-factor single sign-on portal for web applications" /> <meta property="og:description" content="Authelia is an open source multi-factor single sign-on portal for web applications" /> <meta property="og:site_name" content="Authelia" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Security Measures" /> <script type="application/ld+json"> {"headline":"Security Measures","url":"/docs/security/measures.html","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/docs/images/authelia-title.png"}},"@type":"WebPage","description":"Authelia is an open source multi-factor single sign-on portal for web applications","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css" /> <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" /> </head> <body> <a class="github-fork-ribbon" href="https://github.com/authelia/authelia" data-ribbon="Fork me on GitHub" title="Fork me on GitHub">Fork me on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-contrib" viewBox="0 0 24 24"> <title>Survey contribution</title> <?xml version="1.0" encoding="iso-8859-1"?> <!-- Generator: Adobe Illustrator 19.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0) --> <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve"> <path style="fill:#FEC9A3;" d="M507.661,503.322V399.907c0-11.325-5.528-21.938-14.805-28.438l-65.25-45.681 c-4.374-3.063-9.589-4.703-14.935-4.703h-52.536l0.868,148.48c0.321,15.473,10.431,29.028,25.166,33.757H507.661z"/> <path style="fill:#FABD91;" d="M455.593,503.322h-60.746c-19.17,0-34.712-15.542-34.712-34.712v-34.712h60.746L455.593,503.322z"/> <path style="fill:#88B337;" d="M229.966,60.746c-5.979,0.009-11.889,1.258-17.356,3.662V0H56.407 C27.648,0,4.339,23.309,4.339,52.068v156.203h64.408c-9.633-21.938,0.338-47.538,22.285-57.17 c21.938-9.633,47.538,0.338,57.17,22.285c4.886,11.116,4.886,23.778,0,34.894h64.408v-64.408 c21.938,9.633,47.538-0.338,57.17-22.285s-0.338-47.538-22.285-57.17C241.976,61.978,236.006,60.737,229.966,60.746z"/> <path style="fill:#E8594A;" d="M420.881,52.068C420.881,23.309,397.572,0,368.814,0H212.61v64.408 c21.938-9.633,47.538,0.338,57.17,22.285c9.633,21.938-0.338,47.538-22.285,57.17c-11.116,4.886-23.778,4.886-34.894,0v64.408 h64.408c-9.633,21.938,0.338,47.538,22.285,57.17c21.938,9.633,47.538-0.338,57.17-22.285c4.886-11.116,4.886-23.778,0-34.894 h64.417V52.068z"/> <path style="fill:#D65245;" d="M420.881,57.023C371.278,126.03,281.73,165.228,212.61,186.325v21.947h64.408 c-9.633,21.938,0.338,47.538,22.285,57.17c21.938,9.633,47.538-0.338,57.17-22.285c4.886-11.116,4.886-23.778,0-34.894h64.408 V57.023z"/> <path style="fill:#FDB62F;" d="M195.254,277.695c5.979,0.009,11.889,1.258,17.356,3.662v-73.086h-64.408 c9.633-21.938-0.338-47.538-22.285-57.17c-21.947-9.633-47.538,0.338-57.17,22.285c-4.886,11.116-4.886,23.778,0,34.894H4.339 v156.203c0,28.759,23.309,52.068,52.068,52.068H212.61v-55.73c-21.938,9.633-47.538-0.338-57.17-22.285 c-9.633-21.938,0.338-47.538,22.285-57.17C183.244,278.927,189.214,277.686,195.254,277.695z"/> <path style="fill:#FFA719;" d="M4.339,364.475c0,28.759,23.309,52.068,52.068,52.068H212.61v-55.73 c-21.834,9.615-47.33-0.286-56.945-22.12c-2.23-5.068-3.471-10.526-3.645-16.063c-46.523,20.749-96.751,31.918-147.682,32.846 V364.475z"/> <path style="fill:#4398D1;" d="M443.574,389.641l-54.906-146.658l-60.303,22.71c16.809,17.122,16.549,44.631-0.573,61.431 c-17.122,16.801-44.631,16.549-61.431-0.573c-8.556-8.721-13.052-20.636-12.375-32.837l-60.295,22.71l25.687,68.634 c-5.962-0.338-11.932,0.573-17.529,2.673c-22.407,8.695-33.514,33.905-24.819,56.311c8.548,22.016,33.098,33.202,55.322,25.183 c5.597-2.109,10.7-5.372,14.969-9.563L266.9,512l146.241-55.079C440.094,446.716,453.71,416.62,443.574,389.641z"/> <path style="fill:#3E8FC9;" d="M415.258,314.012c-59.878,89.557-172.127,120.832-237.872,131.601 c9.225,21.947,34.495,32.256,56.441,23.031c5.025-2.109,9.607-5.163,13.494-8.982L266.9,512l146.241-55.079 c26.945-10.205,40.552-40.283,30.434-67.254L415.258,314.012z"/> <path style="fill:#80A834;" d="M229.966,60.746c-5.979,0.009-11.889,1.258-17.356,3.662V51.816 C147.63,111.633,59.592,144.67,4.339,160.768v47.503h64.408c-9.633-21.938,0.338-47.538,22.285-57.17 c21.938-9.633,47.538,0.338,57.17,22.285c4.886,11.116,4.886,23.778,0,34.894h64.408v-64.408 c21.938,9.633,47.538-0.338,57.17-22.285s-0.338-47.538-22.285-57.17C241.976,61.978,236.006,60.737,229.966,60.746z"/> <path style="fill:#FEC9A3;" d="M403.682,390.665c-8.305-8.47-21.903-8.609-30.373-0.304c-8.47,8.305-8.609,21.903-0.304,30.373 c0.104,0.104,0.2,0.208,0.304,0.304l30.217,30.217c0,28.759,23.309,52.068,52.068,52.068l0,0h52.068v-8.678L403.682,390.665z"/> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/docs/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/" class="nav-list-link">Home</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/home/architecture.html" class="nav-list-link">Architecture</a></li><li class="nav-list-item "><a href="/docs/home/supported-proxies.html" class="nav-list-link">Supported Proxies</a></li></ul></li><li class="nav-list-item"><a href="/docs/getting-started.html" class="nav-list-link">Getting Started</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/features/" class="nav-list-link">Features</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/features/first-factor.html" class="nav-list-link">First Factor</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/features/2fa/" class="nav-list-link">Second Factor</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/features/2fa/one-time-password.html" class="nav-list-link">Time-based One-Time Password</a> </li><li class="nav-list-item "> <a href="/docs/features/2fa/security-key.html" class="nav-list-link">Security Keys</a> </li><li class="nav-list-item "> <a href="/docs/features/2fa/push-notifications.html" class="nav-list-link">Push Notification</a> </li></ul></li><li class="nav-list-item "><a href="/docs/features/single-factor.html" class="nav-list-link">Single Factor</a></li><li class="nav-list-item "><a href="/docs/features/password-reset.html" class="nav-list-link">Password Reset</a></li><li class="nav-list-item "><a href="/docs/features/access-control.html" class="nav-list-link">Access Control</a></li><li class="nav-list-item "><a href="/docs/features/regulation.html" class="nav-list-link">Regulation</a></li><li class="nav-list-item "><a href="/docs/features/statelessness.html" class="nav-list-link">Statelessness</a></li><li class="nav-list-item "><a href="/docs/features/logout.html" class="nav-list-link">Logout</a></li><li class="nav-list-item "><a href="/docs/features/password-policy.html" class="nav-list-link">Password Policy</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/configuration/" class="nav-list-link">Configuration</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/configuration/access-control.html" class="nav-list-link">Access Control</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/configuration/authentication/" class="nav-list-link">Authentication Backends</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/configuration/authentication/file.html" class="nav-list-link">File</a> </li><li class="nav-list-item "> <a href="/docs/configuration/authentication/ldap.html" class="nav-list-link">LDAP</a> </li></ul></li><li class="nav-list-item "><a href="/docs/configuration/duo-push-notifications.html" class="nav-list-link">Duo Push Notifications</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/configuration/identity-providers/" class="nav-list-link">Identity Providers</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/configuration/identity-providers/oidc.html" class="nav-list-link">OpenID Connect</a> </li></ul></li><li class="nav-list-item "><a href="/docs/configuration/logging.html" class="nav-list-link">Logging</a></li><li class="nav-list-item "><a href="/docs/configuration/migration.html" class="nav-list-link">Migration</a></li><li class="nav-list-item "><a href="/docs/configuration/miscellaneous.html" class="nav-list-link">Miscellaneous</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/configuration/notifier/" class="nav-list-link">Notifier</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/configuration/notifier/filesystem.html" class="nav-list-link">Filesystem</a> </li><li class="nav-list-item "> <a href="/docs/configuration/notifier/smtp.html" class="nav-list-link">SMTP</a> </li></ul></li><li class="nav-list-item "><a href="/docs/configuration/ntp.html" class="nav-list-link">NTP</a></li><li class="nav-list-item "><a href="/docs/configuration/regulation.html" class="nav-list-link">Regulation</a></li><li class="nav-list-item "><a href="/docs/configuration/secrets.html" class="nav-list-link">Secrets</a></li><li class="nav-list-item "><a href="/docs/configuration/server.html" class="nav-list-link">Server</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/configuration/session/" class="nav-list-link">Session</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/configuration/session/redis.html" class="nav-list-link">Redis</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/configuration/storage/" class="nav-list-link">Storage Backends</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/configuration/storage/mariadb.html" class="nav-list-link">MariaDB</a> </li><li class="nav-list-item "> <a href="/docs/configuration/storage/mysql.html" class="nav-list-link">MySQL</a> </li><li class="nav-list-item "> <a href="/docs/configuration/storage/postgres.html" class="nav-list-link">PostgreSQL</a> </li><li class="nav-list-item "> <a href="/docs/configuration/storage/sqlite.html" class="nav-list-link">SQLite</a> </li><li class="nav-list-item "> <a href="/docs/configuration/storage/migrations.html" class="nav-list-link">Migrations</a> </li></ul></li><li class="nav-list-item "><a href="/docs/configuration/theme.html" class="nav-list-link">Theme</a></li><li class="nav-list-item "><a href="/docs/configuration/webauthn.html" class="nav-list-link">Webauthn</a></li><li class="nav-list-item "><a href="/docs/configuration/one-time-password.html" class="nav-list-link">Time-based One-Time Password</a></li><li class="nav-list-item "><a href="/docs/configuration/password_policy.html" class="nav-list-link">Password Policy</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/deployment/" class="nav-list-link">Deployment</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/deployment/deployment-lite.html" class="nav-list-link">Deployment - Lite</a></li><li class="nav-list-item "><a href="/docs/deployment/deployment-ha.html" class="nav-list-link">Deployment - Highly-Available</a></li><li class="nav-list-item "><a href="/docs/deployment/deployment-kubernetes.html" class="nav-list-link">Deployment - Kubernetes</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/deployment/supported-proxies/" class="nav-list-link">Proxy Integration</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/deployment/supported-proxies/haproxy.html" class="nav-list-link">HAProxy</a> </li><li class="nav-list-item "> <a href="/docs/deployment/supported-proxies/nginx.html" class="nav-list-link">NGINX</a> </li><li class="nav-list-item "> <a href="/docs/deployment/supported-proxies/traefik1.x.html" class="nav-list-link">Traefik 1.x</a> </li><li class="nav-list-item "> <a href="/docs/deployment/supported-proxies/traefik2.x.html" class="nav-list-link">Traefik 2.x</a> </li></ul></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/security/" class="nav-list-link">Security</a><ul class="nav-list "><li class="nav-list-item active"><a href="/docs/security/measures.html" class="nav-list-link active">Security Measures</a></li><li class="nav-list-item "><a href="/docs/security/threat-model.html" class="nav-list-link">Threat Model</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/contributing/" class="nav-list-link">Contributing</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/contributing/build-and-dev.html" class="nav-list-link">Build & Dev</a></li><li class="nav-list-item "><a href="/docs/contributing/authelia-scripts.html" class="nav-list-link">Authelia Scripts</a></li><li class="nav-list-item "><a href="/docs/contributing/commitmsg-guidelines.html" class="nav-list-link">Commit Message Guidelines</a></li><li class="nav-list-item "><a href="/docs/contributing/style-guide.html" class="nav-list-link">Style Guide</a></li><li class="nav-list-item "><a href="/docs/contributing/suites.html" class="nav-list-link">Suites</a></li></ul></li><li class="nav-list-item"><a href="/docs/faq.html" class="nav-list-link">FAQ</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/roadmap/" class="nav-list-link">Roadmap</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/roadmap/oidc.html" class="nav-list-link">OpenID Connect</a></li></ul></li><li class="nav-list-item"><a href="/docs/about-us.html" class="nav-list-link">About Us</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/community/" class="nav-list-link">Community</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/community/two-factor-basic-auth.html" class="nav-list-link">2FA through basic auth</a></li><li class="nav-list-item "><a href="/docs/community/using-remote-user-header-for-sso-with-jira.html" class="nav-list-link">Using Remote-User header for SSO with Jira</a></li><li class="nav-list-item "><a href="/docs/community/additional-resources.html" class="nav-list-link">Miscellaneous Additional Resources</a></li><li class="nav-list-item "><a href="/docs/community/example-of-authelia-lite-on-docker-swarm.html" class="nav-list-link">Example of authelia lite on docker swarm</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/community/oidc-integrations.html" class="nav-list-link">Community-Tested OIDC Integrations</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/community/oidc-integrations/portainer.html" class="nav-list-link">Portainer</a> </li><li class="nav-list-item "> <a href="/docs/community/oidc-integrations/proxmox.html" class="nav-list-link">Proxmox</a> </li></ul></li><li class="nav-list-item "><a href="/docs/community/django-integration.html" class="nav-list-link">Integrate Authelia with Django</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Authelia" aria-label="Search Authelia" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="">Security</a></li> <li class="breadcrumb-nav-list-item"><span>Security Measures</span></li> </ol> </nav> <div id="survey-wrapper" style="border: 1px solid #d6d6d6; border-radius: 5px; background-color: #f1f1f1; padding: 20px; display: flex; flex-direction: row; align-items: center;"> <svg viewBox="0 0 24 24" width="32px" height="32px" class="contrib-icon" style="display: inline-block"><use xlink:href="#svg-contrib"></use></svg> <span style="margin-left: 10px">Help the team improve <b>Authelia</b> by taking this <a href="https://forms.gle/aVw6J9jcez97EAhD6" target="_blank">10-second survey</a>.</span> </div> <div id="main-content" class="main-content" role="main"> <h1 id="security-measures"> <a href="#security-measures" class="anchor-heading" aria-labelledby="security-measures"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Security Measures </h1> <h2 id="protection-against-cookie-theft"> <a href="#protection-against-cookie-theft" class="anchor-heading" aria-labelledby="protection-against-cookie-theft"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Protection against cookie theft </h2> <p>Authelia sets several key cookie attributes to prevent cookie theft:</p> <ol> <li><code class="language-plaintext highlighter-rouge">HttpOnly</code> is set forbidding client-side code like javascript from access to the cookie.</li> <li><code class="language-plaintext highlighter-rouge">Secure</code> is set forbidding the browser from sending the cookie to sites which do not use the https scheme.</li> <li><code class="language-plaintext highlighter-rouge">SameSite</code> is by default set to <code class="language-plaintext highlighter-rouge">Lax</code> which prevents it being sent over cross-origin requests.</li> </ol> <p>Read about these attributes in detail on the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie">MDN</a>.</p> <h2 id="protection-against-multi-domain-cookie-attacks"> <a href="#protection-against-multi-domain-cookie-attacks" class="anchor-heading" aria-labelledby="protection-against-multi-domain-cookie-attacks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Protection against multi-domain cookie attacks </h2> <p>Since Authelia uses multi-domain cookies to perform single sign-on, an attacker who poisoned a user’s DNS cache can easily retrieve the user’s cookies by making the user send a request to one of the attacker’s IPs.</p> <p>This is technically mitigated by the <code class="language-plaintext highlighter-rouge">Secure</code> attribute set in cookies by Authelia, however it’s still advisable to only use HTTPS connections with valid certificates and enforce it with HTTP Strict Transport Security (<a href="https://www.nginx.com/blog/http-strict-transport-security-hsts-and-nginx/">HSTS</a>) which will prevent domains from serving over HTTP at all as long as the user has visited the domain before. This means even if the attacker poisons DNS they are unable to get modern browsers to connect to a compromised host unless they can also obtain the certificate.</p> <p>Note that using <a href="https://www.nginx.com/blog/http-strict-transport-security-hsts-and-nginx/">HSTS</a> has consequences. That’s why you should read the blog post nginx has written on <a href="https://www.nginx.com/blog/http-strict-transport-security-hsts-and-nginx/">HSTS</a>.</p> <h2 id="protection-against-username-enumeration"> <a href="#protection-against-username-enumeration" class="anchor-heading" aria-labelledby="protection-against-username-enumeration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Protection against username enumeration </h2> <p>Authelia adaptively delays authentication attempts based on the mean (average) of the previous 10 successful attempts in addition to a small random interval of time. The result of this delay is that it makes it incredibly difficult to determine if the unsuccessful login was the result of a bad password, a bad username, or both. The random interval of time is anything between 0 milliseconds and 85 milliseconds.</p> <p>When Authelia first starts it assumes the last 10 attempts took 1000 milliseconds each. As users login successfully it quickly adjusts to the actual time the login attempts take. This process is independent of the login backend you have configured.</p> <p>The cost of this is low since in the instance of a user not existing it just stops processing the request to delay the login. Lastly the absolute minimum time authentication can take is 250 milliseconds. Both of these measures also have the added effect of creating an additional delay for all authentication attempts increasing the time that a brute-force attack will take, this combined with regulation greatly delays brute-force attacks and the effectiveness of them in general.</p> <h2 id="protections-against-password-cracking-file-authentication-provider"> <a href="#protections-against-password-cracking-file-authentication-provider" class="anchor-heading" aria-labelledby="protections-against-password-cracking-file-authentication-provider"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Protections against password cracking (File authentication provider) </h2> <p>Authelia implements a variety of measures to prevent an attacker cracking passwords if they somehow obtain the file used by the file authentication provider, this is unrelated to LDAP auth.</p> <p>First and foremost Authelia only uses very secure hashing algorithms with sane and secure defaults. The first and default hashing algorithm we use is Argon2id which is currently considered the most secure hashing algorithm. We also support SHA512, which previously was the default.</p> <p>Secondly Authelia uses salting with all hashing algorithms. These salts are generated with a random string generator, which is seeded every time it’s used by a cryptographically secure 1024bit prime number. This ensures that even if an attacker obtains the file, each password has to be brute forced individually.</p> <p>Lastly Authelia’s implementation of Argon2id is highly tunable. You can tune the key length, salt used, iterations (time), parallelism, and memory usage. To read more about this please read how to <a href="/docs/configuration/authentication/file.html">configure</a> file authentication.</p> <h2 id="user-profile-and-group-membership-always-kept-up-to-date-ldap-authentication-provider"> <a href="#user-profile-and-group-membership-always-kept-up-to-date-ldap-authentication-provider" class="anchor-heading" aria-labelledby="user-profile-and-group-membership-always-kept-up-to-date-ldap-authentication-provider"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> User profile and group membership always kept up-to-date (LDAP authentication provider) </h2> <p>This measure is unrelated to the File authentication provider.</p> <p>Authelia by default refreshes the user’s profile and membership every 5 minutes. This ensures that if you alter a users groups in LDAP that their new groups are obtained relatively quickly in order to adjust their access level for applications secured by Authelia.</p> <p>Additionally, it will invalidate any session where the user could not be retrieved from LDAP based on the user filter, for example if they were deleted or disabled provided the user filter is set correctly. These updates occur when a user accesses a resource protected by Authelia. This means you should ensure disabled users or users with expired passwords are not obtainable using the LDAP filter, the default filter for Active Directory implements this behaviour. LDAP implementations vary, so please ask if you need some assistance in configuring this.</p> <p>These protections can be <a href="/docs/configuration/authentication/ldap.html#refresh-interval">tuned</a> according to your security policy by changing refresh_interval, however we believe that 5 minutes is a fairly safe interval.</p> <h2 id="storage-security-measures"> <a href="#storage-security-measures" class="anchor-heading" aria-labelledby="storage-security-measures"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Storage security measures </h2> <p>We force users to encrypt vulnerable data stored in the database. It is strongly advised you do not give this encryption key to anyone. In the instance of a database installation that multiple users have access to, you should aim to ensure that users who have access to the database do not also have access to this key.</p> <p>The encrypted data in the database is as follows:</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: center">Table</th> <th style="text-align: center">Column</th> <th style="text-align: center">Rational</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">totp_configurations</td> <td style="text-align: center">secret</td> <td style="text-align: center">Prevents a <a href="#leaked-database">Leaked Database</a> or <a href="#bad-actors">Bad Actors</a> from compromising security</td> </tr> <tr> <td style="text-align: center">webauthn_devices</td> <td style="text-align: center">public_key</td> <td style="text-align: center">Prevents <a href="#bad-actors">Bad Actors</a> from compromising security</td> </tr> </tbody> </table></div> <h3 id="leaked-database"> <a href="#leaked-database" class="anchor-heading" aria-labelledby="leaked-database"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Leaked Database </h3> <p>A leaked database can reasonably compromise security if there are credentials that are not encrypted. Columns encrypted for this purpose prevent this attack vector.</p> <h3 id="bad-actors"> <a href="#bad-actors" class="anchor-heading" aria-labelledby="bad-actors"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bad Actors </h3> <p>A bad actor who has the SQL password and access to the database can theoretically change another users credential, this theoretically bypasses authentication. Columns encrypted for this purpose prevent this attack vector.</p> <p>A bad actor may also be able to use data in the database to bypass 2FA silently depending on the credentials. In the instance of the U2F public key this is not possible, they can only change it which would eventually alert the user in question. But in the case of TOTP they can use the secret to authenticate without knowledge of the user in question.</p> <h3 id="encryption-key-management"> <a href="#encryption-key-management" class="anchor-heading" aria-labelledby="encryption-key-management"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Encryption key management </h3> <p>You must supply the encryption key in the recommended method of a <a href="/docs/configuration/secrets.html">secret</a> or in one of the other methods available for <a href="/docs/configuration/#configuration">configuration</a>.</p> <p>If you wish to change your encryption key for any reason you can do so using the following steps:</p> <ol> <li>Run the <code class="language-plaintext highlighter-rouge">authelia --version</code> command to determine the version of Authelia you’re running and either download that version or run another container of that version interactively. All the subsequent commands assume you’re running the <code class="language-plaintext highlighter-rouge">authelia</code> binary in the current working directory. You will have to adjust this according to how you’re running it.</li> <li>Run the <code class="language-plaintext highlighter-rouge">./authelia storage encryption change-key --help</code> command.</li> <li>Stop Authelia. <ul> <li>You can skip this step, however note that any data changed between the time you make the change and the time when you stop Authelia i.e. via user registering a device; will be encrypted with the incorrect key.</li> </ul> </li> <li>Run the <code class="language-plaintext highlighter-rouge">./authelia storage encryption change-key</code> command with the appropriate parameters. <ul> <li>The help from step 1 will be useful here. The easiest method to accomplish this is with the <code class="language-plaintext highlighter-rouge">--config</code>, <code class="language-plaintext highlighter-rouge">--encryption-key</code>, and <code class="language-plaintext highlighter-rouge">--new-encryption-key</code> parameters.</li> </ul> </li> <li>Update the encryption key Authelia uses on startup.</li> <li>Start Authelia.</li> </ol> <h2 id="notifier-security-measures-smtp"> <a href="#notifier-security-measures-smtp" class="anchor-heading" aria-labelledby="notifier-security-measures-smtp"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Notifier security measures (SMTP) </h2> <p>The SMTP Notifier implementation does not allow connections that are not secure without changing default configuration values.</p> <p>As such all SMTP connections require the following:</p> <ol> <li>TLS Connection (STARTTLS or SMTPS) has been negotiated before authentication or sending emails (unauthenticated connections require it as well)</li> <li>Valid X509 Certificate presented to the client during the TLS handshake</li> </ol> <p>There is an option to disable both of these security measures however they are <strong>not recommended</strong>.</p> <p>The following configuration options exist to configure the security level in order of most preferable to least preferable:</p> <h3 id="configuration-option-certificates_directory"> <a href="#configuration-option-certificates_directory" class="anchor-heading" aria-labelledby="configuration-option-certificates_directory"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configuration Option: certificates_directory </h3> <p>You can <a href="/docs/configuration/miscellaneous.html#certificates_directory">configure a directory</a> of certificates for Authelia to trust. These certificates can either be CA’s or individual public certificates that should be trusted. These are added in addition to the environments PKI trusted certificates if available. This is useful for trusting a certificate that is self-signed without drastically reducing security. This is the most recommended workaround to not having a valid PKI trusted certificate as it gives you complete control over which ones are trusted without disabling critically needed validation of the identity of the target service.</p> <p>Read more in the <a href="/docs/configuration/miscellaneous.html#certificates_directory">documentation</a> for this option.</p> <h3 id="configuration-option-tlsskip_verify"> <a href="#configuration-option-tlsskip_verify" class="anchor-heading" aria-labelledby="configuration-option-tlsskip_verify"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configuration Option: tls.skip_verify </h3> <p>The <a href="/docs/configuration/notifier/smtp.html#tls">tls.skip_verify</a> option allows you to skip verifying the certificate entirely which is why <a href="#configuration-option-certificates_directory">certificates_directory</a> is preferred over this. This will effectively mean you cannot be sure the certificate is valid which means an attacker via DNS poisoning or MITM attacks could intercept emails from Authelia compromising a user’s security without their knowledge.</p> <h3 id="configuration-option-disable_require_tls"> <a href="#configuration-option-disable_require_tls" class="anchor-heading" aria-labelledby="configuration-option-disable_require_tls"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configuration Option: disable_require_tls </h3> <p>Authelia by default ensures that the SMTP server connection is secured via STARTTLS or SMTPS prior to sending sensitive information. The <a href="/docs/configuration/notifier/smtp.html#disable_require_tls">disable_require_tls</a> disables this requirement which means the emails are sent in plain text. This is the least secure option as it effectively removes the validation of SMTP certificates and removes the encryption offered by the STARTTLS/SMTPS connection all together.</p> <p>This means not only can the vulnerabilities of the <a href="#configuration-option-tlsskip_verify">skip_verify</a> option be exploited, but any router or switch along the route of the email which receives the packets could be used to silently exploit the plain text nature of the email. This is only usable currently with authentication disabled (comment out the password) and as such is only an option for SMTP servers that allow unauthenticated relay (bad practice).</p> <h3 id="smtps-vs-starttls"> <a href="#smtps-vs-starttls" class="anchor-heading" aria-labelledby="smtps-vs-starttls"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SMTPS vs STARTTLS </h3> <p>All connections start as plain text and are upgraded via STARTTLS. SMTPS is an exception to this rule where the connection is over TLS. As SMTPS is deprecated, the only way to configure this is to set the SMTP <a href="/docs/configuration/notifier/smtp.html#port">port</a> to the officially recognized SMTPS port of 465 which will cause Authelia to automatically consider it to be a SMTPS connection. As such your SMTP server, if not offering SMTPS, should not be listening on port 465 which is bad practice anyway.</p> <h2 id="protection-against-open-redirects"> <a href="#protection-against-open-redirects" class="anchor-heading" aria-labelledby="protection-against-open-redirects"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Protection against open redirects </h2> <p>Authelia protects your users against open redirect attacks by always checking if redirection URLs are pointing to a subdomain of the domain protected by Authelia. This prevents phishing campaigns tricking users into visiting infected websites leveraging legit links.</p> <h2 id="mutual-tls"> <a href="#mutual-tls" class="anchor-heading" aria-labelledby="mutual-tls"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Mutual TLS </h2> <p>For the best security protection, configuration with TLS is highly recommended. TLS is used to secure the connection between the proxies and Authelia instances meaning that an attacker on the network cannot perform a man-in-the-middle attack on those connections. However, an attacker on the network can still impersonate proxies but this can be prevented by configuring mutual TLS. Mutual TLS brings mutual authentication between Authelia and the proxies. Any other party attempting to contact Authelia would not even be able to create a TCP connection. This measure is recommended in all cases except if you already configured some kind of ACLs specifically allowing the communication between proxies and Authelia instances like in a service mesh or some kind of network overlay.</p> <p>To configure mutual TLS, please refer to <a href="/docs/configuration/server.html#client_certificates">this document</a></p> <h2 id="additional-security"> <a href="#additional-security" class="anchor-heading" aria-labelledby="additional-security"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Additional security </h2> <h3 id="reset-password"> <a href="#reset-password" class="anchor-heading" aria-labelledby="reset-password"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Reset Password </h3> <p>It’s possible to disable the reset password functionality and is an optional adjustment to consider for anyone wanting to increase security. See the <a href="/docs/configuration/authentication/#disable_reset_password">configuration</a> for more information.</p> <h3 id="session-security"> <a href="#session-security" class="anchor-heading" aria-labelledby="session-security"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Session security </h3> <p>We have a few options to configure the security of a session. The main and most important one is the session secret. This is used to encrypt the session data when it is stored in the <a href="/docs/configuration/session/redis.html">Redis</a> key value database. The value of this option should be long and as random as possible. See more in the <a href="/docs/configuration/session/#secret">documentation</a> for this option.</p> <p>The validity period of session is highly configurable. For example in a highly security conscious domain you could set the session <a href="/docs/configuration/session/#remember_me_duration">remember_me_duration</a> to 0 to disable this feature, and set the <a href="/docs/configuration/session/#expiration">expiration</a> to 2 hours and the <a href="/docs/configuration/session/#inactivity">inactivity</a> of 10 minutes. Configuring the session security in this manner would mean if the cookie age was more than 2 hours or if the user was inactive for more than 10 minutes the session would be destroyed.</p> <h3 id="additional-proxy-protection-measures"> <a href="#additional-proxy-protection-measures" class="anchor-heading" aria-labelledby="additional-proxy-protection-measures"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Additional proxy protection measures </h3> <p>You can also apply the following headers to your proxy configuration for improving security. Please read the relevant documentation for these headers before applying them blindly.</p> <h4 id="nginx"> <a href="#nginx" class="anchor-heading" aria-labelledby="nginx"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> nginx </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># We don't want any credentials / TOTP secret key / QR code to be cached by
# the client
add_header Cache-Control "no-store";
add_header Pragma "no-cache";

# Clickjacking / XSS protection

# We don't want Authelia's login page to be rendered within a &lt;frame&gt;,
# &lt;iframe&gt; or &lt;object&gt; from an external website.
add_header X-Frame-Options "SAMEORIGIN";

# Block pages from loading when they detect reflected XSS attacks.
add_header X-XSS-Protection "1; mode=block";
</code></pre></div></div> <h4 id="traefik-2x---kubernetes-crd"> <a href="#traefik-2x---kubernetes-crd" class="anchor-heading" aria-labelledby="traefik-2x---kubernetes-crd"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Traefik 2.x - Kubernetes CRD </h4> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">traefik.containo.us/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Middleware</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">headers-authelia</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">headers</span><span class="pi">:</span>
    <span class="na">browserXssFilter</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">customFrameOptionsValue</span><span class="pi">:</span> <span class="s2">"</span><span class="s">SAMEORIGIN"</span>
    <span class="na">customResponseHeaders</span><span class="pi">:</span>
      <span class="na">Cache-Control</span><span class="pi">:</span> <span class="s2">"</span><span class="s">no-store"</span>
      <span class="na">Pragma</span><span class="pi">:</span> <span class="s2">"</span><span class="s">no-cache"</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">traefik.containo.us/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">IngressRoute</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">authelia</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">entryPoints</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">http</span>
  <span class="na">routes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">match</span><span class="pi">:</span> <span class="s">Host(`auth.example.com`) &amp;&amp; PathPrefix(`/`)</span>
      <span class="na">kind</span><span class="pi">:</span> <span class="s">Rule</span>
      <span class="na">priority</span><span class="pi">:</span> <span class="m">1</span>
      <span class="na">middlewares</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">headers-authelia</span>
          <span class="na">namespace</span><span class="pi">:</span> <span class="s">authelia</span>
      <span class="na">services</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">authelia</span>
          <span class="na">port</span><span class="pi">:</span> <span class="m">80</span>
</code></pre></div></div> <h4 id="traefik-2x---docker-compose"> <a href="#traefik-2x---docker-compose" class="anchor-heading" aria-labelledby="traefik-2x---docker-compose"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Traefik 2.x - docker-compose </h4> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">services</span><span class="pi">:</span>
  <span class="na">authelia</span><span class="pi">:</span>
    <span class="na">labels</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">traefik.http.routers.authelia.middlewares=authelia-headers"</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">traefik.http.middlewares.authelia-headers.headers.browserXssFilter=true"</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">traefik.http.middlewares.authelia-headers.headers.customFrameOptionsValue=SAMEORIGIN"</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">traefik.http.middlewares.authelia-headers.headers.customResponseHeaders.Cache-Control=no-store"</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">traefik.http.middlewares.authelia-headers.headers.customResponseHeaders.Pragma=no-cache"</span>
</code></pre></div></div> <h3 id="more-protections-measures-with-fail2ban"> <a href="#more-protections-measures-with-fail2ban" class="anchor-heading" aria-labelledby="more-protections-measures-with-fail2ban"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> More protections measures with fail2ban </h3> <p>If you are running fail2ban, adding a filter and jail for Authelia can reduce load on the application / web server. Fail2ban will ban IPs exceeding a threshold of repeated failed logins at the firewall level of your host. If you are using Docker, the Authelia log file location has to be mounted from the host system to the container for fail2ban to access it.</p> <p>Create a configuration file in the <code class="language-plaintext highlighter-rouge">filter.d</code> folder with the content below. In Debian-based systems the folder is typically located at <code class="language-plaintext highlighter-rouge">/etc/fail2ban/filter.d</code>.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Fail2Ban filter for Authelia

# Make sure that the HTTP header "X-Forwarded-For" received by Authelia's backend
# only contains a single IP address (the one from the end-user), and not the proxy chain
# (it is misleading: usually, this is the purpose of this header).

# the failregex rule counts every failed 1FA attempt (first line, wrong username or password) and failed 2FA attempt
# second line) as a failure.
# the ignoreregex rule ignores debug, info and warning messages as all authentication failures are flagged as errors

[Definition]
failregex = ^.*Unsuccessful 1FA authentication attempt by user .*remote_ip="?&lt;HOST&gt;"? stack.*
            ^.*Unsuccessful (TOTP|Duo|U2F) authentication attempt by user .*remote_ip="?&lt;HOST&gt;"? stack.*

ignoreregex = ^.*level=debug.*
              ^.*level=info.*
              ^.*level=warning.*
</code></pre></div></div> <p>Modify the <code class="language-plaintext highlighter-rouge">jail.local</code> file. In Debian-based systems the folder is typically located at <code class="language-plaintext highlighter-rouge">/etc/fail2ban/</code>. If the file does not exist, create it by copying the jail.conf <code class="language-plaintext highlighter-rouge">cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local</code>. Add an Authelia entry to the “Jails” section of the file:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[authelia]
enabled = true
port = http,https,9091
filter = authelia
logpath = /path-to-your-authelia.log
maxretry = 3
bantime = 1d
findtime = 1d
chain = DOCKER-USER
</code></pre></div></div> <p>If you are not using Docker remove the line “chain = DOCKER-USER”. You will need to restart the fail2ban service for the changes to take effect.</p> <h2 id="container-privilege-de-escalation"> <a href="#container-privilege-de-escalation" class="anchor-heading" aria-labelledby="container-privilege-de-escalation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Container privilege de-escalation </h2> <p>Authelia will run as the root user and group by default, there are two options available to run as a non-root user and group.</p> <p>It is recommended which ever approach you take that to secure the sensitive files Authelia requires access to that you make sure the chmod of the files does not inadvertently allow read access to the files by users who do not need access to them.</p> <p>Examples:</p> <p>If you wanted to run Authelia as UID 8000, and wanted the GID of 9000 to also have read access to the files you might do the following assuming the files were in the relative path <code class="language-plaintext highlighter-rouge">.data/authelia</code>:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">chown</span> <span class="nt">-r</span> 8000:9000 .data/authelia
find .data/authelia/ <span class="nt">-type</span> d <span class="nt">-exec</span> <span class="nb">chmod </span>750 <span class="o">{}</span> <span class="se">\;</span>
find .data/authelia/ <span class="nt">-type</span> f <span class="nt">-exec</span> <span class="nb">chmod </span>640 <span class="o">{}</span> <span class="se">\;</span>
</code></pre></div></div> <p>If you wanted to run Authelia as UID 8000, and wanted the GID of 9000 to also have write access to the files you might do the following assuming the files were in the relative path <code class="language-plaintext highlighter-rouge">.data/authelia</code>:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">chown</span> <span class="nt">-r</span> 8000:9000 .data/authelia
find .data/authelia/ <span class="nt">-type</span> d <span class="nt">-exec</span> <span class="nb">chmod </span>770 <span class="o">{}</span> <span class="se">\;</span>
find .data/authelia/ <span class="nt">-type</span> f <span class="nt">-exec</span> <span class="nb">chmod </span>660 <span class="o">{}</span> <span class="se">\;</span>
</code></pre></div></div> <h3 id="docker-user-directive"> <a href="#docker-user-directive" class="anchor-heading" aria-labelledby="docker-user-directive"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Docker user directive </h3> <p>The docker user directive allows you to configure the user the entrypoint runs as. This is generally the most secure option for containers as no process accessible to the container ever runs as root which prevents a compromised container from exploiting unnecessary privileges.</p> <p>The directive can either be applied in your <code class="language-plaintext highlighter-rouge">docker run</code> command using the <code class="language-plaintext highlighter-rouge">--user</code> argument or by the docker-compose <code class="language-plaintext highlighter-rouge">user:</code> key. The examples below assume you’d like to run the container as UID 8000 and GID 9000.</p> <p>Example for the docker CLI:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="nt">--user</span> 8000:9000 <span class="nt">-v</span> /authelia:/config authelia/authelia:latest
</code></pre></div></div> <p>Example for docker-compose:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>version: '3.8'
services:
  authelia:
    image: authelia/authelia
    container_name: authelia
    user: 8000:9000
    volumes:
      - ./authelia:/config
</code></pre></div></div> <p>Running the container in this way requires that you manually adjust the file owner at the very least as described above. If you do not do so it will likely cause Authelia to exit immediately. This option takes precedence over the PUID and PGID environment variables below, so if you use it then changing the PUID and PGID have zero effect.</p> <h3 id="puidpgid-environment-variables-using-the-entrypoint"> <a href="#puidpgid-environment-variables-using-the-entrypoint" class="anchor-heading" aria-labelledby="puidpgid-environment-variables-using-the-entrypoint"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PUID/PGID environment variables using the entrypoint </h3> <p>The second option is to use the <code class="language-plaintext highlighter-rouge">PUID</code> and <code class="language-plaintext highlighter-rouge">PGID</code> environment variables. When the container entrypoint is executed as root, the entrypoint automatically runs the Authelia process as this user. An added benefit of using the environment variables is the mounted volumes ownership will automatically be changed for you. It is still recommended that you run the find chmod examples above in order to secure the files even further especially on servers multiple people have access to.</p> <p>The examples below assume you’d like to run the container as UID 8000 and GID 9000.</p> <p>Example for the docker CLI:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="nt">-e</span> <span class="nv">PUID</span><span class="o">=</span>1000 <span class="nt">-e</span> <span class="nv">PGID</span><span class="o">=</span>1000 <span class="nt">-v</span> /authelia:/config authelia/authelia:latest
</code></pre></div></div> <p>Example for docker-compose:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>version: '3.8'
services:
  authelia:
    image: authelia/authelia
    container_name: authelia
    environment:
      PUID: 1000
      PGID: 1000
    volumes:
      - ./authelia:/config
</code></pre></div></div> <hr> <footer> <p class="text-small text-grey-dk-000 mb-0">Copyright &copy; 2022 Authelia. Distributed by an <a href="https://github.com/authelia/authelia/blob/master/LICENSE">Apache 2.0 license.</a> </p> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
